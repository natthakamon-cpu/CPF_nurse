<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>{{ item_name }}</title>

  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <style>
    *{ box-sizing:border-box; }
    body{ font-family:'Sarabun',sans-serif; background:#f4f6f8; margin:0; }
    .header{ width:100%; background:#fff; border-bottom:1px solid #e0e0e0; padding:14px 40px; display:flex; align-items:center; justify-content:space-between; }
    .header-left{ display:flex; align-items:center; gap:12px; font-size:20px; font-weight:700; color:#5b2c83; }
    .header-left i{ font-size:26px; }
    .header-right{ display:flex; align-items:center; gap:16px; font-size:14px; }
    .logout-btn{ background:#ff6b6b; color:#fff; padding:8px 16px; border-radius:6px; text-decoration:none; font-weight:600; }

    .container{
      max-width:1500px; background:#fff; margin:40px auto; padding:40px;
      border-radius:16px; box-shadow:0 8px 25px rgba(0,0,0,0.25);
    }

    .top-bar{ text-align:left; margin-bottom:10px; }

    .back-menu-btn{
    display:inline-block;
    background:#28a745;
    color:white;
    padding:10px 20px;
    font-size:20px;
    border-radius:8px;
    text-decoration:none;
    box-shadow:0 4px 10px rgba(0,0,0,0.2);
    transition:0.2s;
    }

    .back-menu-btn:hover{ background:#218838; }


    .title{ text-align:center; font-size:32px; font-weight:800; margin:10px 0 26px; color:#2c3e50; }

    hr{ margin:34px 0; border:none; border-top:1px solid #ddd; }

    .section-title{
      display:inline-block;
      background: linear-gradient(135deg, #d9fbe3, #b8f2d2);
      color:#1f6f43;
      padding:10px 22px;
      border-radius:14px;
      font-size:26px;
      font-weight:700;
      margin-bottom:20px;
      box-shadow:0 4px 10px rgba(0,0,0,0.15);
    }

    label{ font-weight:700; display:block; margin-top:14px; }
    input{
      width:100%; padding:12px; font-size:22px; margin-top:6px;
      border-radius:10px; border:1.5px solid #d6e2ec; background:#fbfdff;
    }
    input:focus{ outline:none; border-color:#7bb7e8; background:#fff; }

    button{
      font-size:22px; padding:12px 26px; border:none; border-radius:10px;
      cursor:pointer; background:#4a90e2; color:#fff; margin-top:18px; font-weight:800;
    }
    button:hover{ background:#357abd; }

    .add-lot-box{
      background: linear-gradient(135deg, #daf8ffff, #a9eeffff);
      padding:26px; border-radius:18px;
      box-shadow:0 6px 18px rgba(0,0,0,0.2);
    }

    .lot-box{
      background:#fff; border-radius:14px;
      padding:18px 22px; margin-bottom:18px;
      box-shadow:0 4px 14px rgba(0,0,0,0.15);
    }
    .lot-header{
      display:inline-block; background:#ffe066; color:#000;
      font-weight:900; padding:4px 12px; border-radius:8px; margin-bottom:12px;
    }

    .delete-btn{ background:#e74c3c; }
    .delete-btn:hover{ background:#c0392b; }

    .footer{ width:100%; background:#dcdcdc; text-align:center; padding:18px; font-size:14px; color:#555; margin-top:60px; }
  </style>
</head>

<body>
  <div class="header">
    <div class="header-left">
      <i class="fa-solid fa-stethoscope"></i>
      ‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• CPF ‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô
    </div>
    <div class="header-right">
      {{ session.get('user_name', 'User') }} ({{ session.get('role', 'user') }}) | ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô Safety
      <a href="/logout" class="logout-btn">‡∏≠‡∏≠‡∏Å</a>
    </div>
  </div>

  <div class="container">
    <div class="top-bar">
     <a class="back-menu-btn" href="{{ back_url }}">‚¨Ö ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</a>
    </div>

    <div class="title">{{ item_name }}</div>

    <hr>
    <div class="section-title">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏° Lot</div>

    <div class="add-lot-box">
      <form id="addLotForm" method="post" action="/other/{{ item_name | urlencode }}/add_lot">
        <label>‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</label>
        <input type="date" name="expire_date" required>

        <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°</label>
        <input type="number" name="qty" min="1" required>

        <label>‡∏£‡∏≤‡∏Ñ‡∏≤ / Lot (‡∏ö‡∏≤‡∏ó)</label>
        <input type="number" name="price" min="1" required>

        <button type="submit">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Lot</button>
      </form>
    </div>

    <hr>
    <div class="section-title">üì¶ Lot ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà</div>

    {% if lots %}
      {% for lot in lots %}
        <div class="lot-box">
          <div class="lot-header">{{ lot.lot_name }}</div>
          <div>‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏: {{ lot.expire_date }}</div>
          <div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: {{ lot.qty_total }}</div>
          <div>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: {{ lot.qty_remain }}</div>
          <div>‡∏£‡∏≤‡∏Ñ‡∏≤ / Lot: {{ "%.2f"|format(lot.price_per_lot) }} ‡∏ö‡∏≤‡∏ó</div>
          <div>‡∏£‡∏≤‡∏Ñ‡∏≤ / ‡∏´‡∏ô‡πà‡∏ß‡∏¢: {{ "%.2f"|format(lot.price_per_unit) }} ‡∏ö‡∏≤‡∏ó</div>

          <form method="post" action="/other_lot/${id}/delete" onsubmit="return confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö Lot ‡∏ô‡∏µ‡πâ ?');">
            <button class="delete-btn">üóë ‡∏•‡∏ö Lot</button>
          </form>
        </div>
      {% endfor %}
    {% else %}
      <p style="color:#999;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Lot ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ</p>
    {% endif %}
  </div>

  <div class="footer">¬© 2026 Safety Officer, CPF Khon Kaen Feedmill</div>
</body>
</html>
